---
title: 函数重载
type: blog
date: 2018-05-06
---

## 描述

函数重载是函数的一种特殊情况，C++允许在同一作用域中声明几个功能类似的同名函数，
这些同名函数的形参列表必须不同。函数重载常用来处理实现功能类似，而数据类型不同的
问题。

```cpp
#include <iostream>
using namespace std;
int Add(int x, int y)
{
    return x + y;
}

double Add(double x, double y)
{
    return x + y;
}
int main()
{
    cout << Add(1, 2) << endl;//打印1+2的结果
    cout << Add(1.1, 2.2) << endl;//打印1.1+2.2的结果
    return 0;
}
```

> 注意：形参列表不同是指参数个数、参数类型或者参数顺序不同，若仅仅是返回类型不同
> ，则不能构成重载。

## 函数重载的原理(名字修饰)

为什么 C++支持函数重载，而 C 语言不支持函数重载呢？

我们知道，一个 C/C++程序要运行起来都需要经历以下几个阶段: [预处理], [编译],
[汇编], [链接]。

在编译阶段会将程序中的每个源文件的全局范围的变量符号分别进行汇总。

在汇编阶段会给每个源文件汇总出来的符号分配一个地址（若符号只是一个声明，则给其分
配一个无意义的地址），然后分别生成一个符号表。

最后在链接期间会将每个源文件的符号表进行合并，若不同源文件的符号表中出现了相同的
符号，则取合法的地址为合并后的地址（重定位）。

在 C 语言中，汇编阶段进行符号汇总时，一个函数汇总后的符号就是其函数名，所以当汇
总时发现多个相同的函数符号时，编译器便会报错。

而 C++在进行符号汇总时，对函数的名字修饰做了改动，函数汇总出的符号不再单单是函数
的函数名，而是通过其参数的类型和个数以及顺序等信息汇总出 一个符号，这样一来，就
算是函数名相同的函数，只要其参数的类型或参数的个数或参数的顺序不同，那么汇总出来
的符号也就不同了。

注：不同编译器下，对函数名的修饰不同，但都是一样的。

## 总结

1. C 语言不能支持重载，是因为同名函数没办法区分。而 C++是通过函数修饰规则来区分
   的，只要函数的形参列表不同，修饰出来的名字就不一样，也就支持了重载。
2. 另外我们也理解了，为什么函数重载要求参数不同，根返回值没关系。

**extern “C”**:   有时候在 C++工程中可能需要将某些函数按照 C 的风格来编译，在函
数前加 “extern C”，意思是告诉编译器，将该函数按照 C 语言规则来编译。

注意：在函数前加“extern C”后，该函数便不能支持重载了
